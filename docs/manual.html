<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Reference manual for Obi 1.0</title>
    <link rel="stylesheet" type="text/css" href="obi.css" />
  </head>
  <body>
    <div id="top">
      <h1>Reference manual for Obi 1.0</h1>
    </div>
    <p>
      <code>$Id$</code>
    </p>
    <div id="toc">
      <h2>Table of contents</h2>
      <ul>
        <li>
          <a href="#id18408">Views</a>
          <ul>
            <li>
              <a href="#id18411">Strips view</a>
            </li>
            <li>
              <a href="#id18422">TOC view</a>
            </li>
            <li>
              <a href="#id18426">Metadata view</a>
            </li>
            <li>
              <a href="#id18429">Search view</a>
            </li>
            <li>
              <a href="#id18433">Transport bar</a>
            </li>
          </ul>
        </li>
        <li>
          <a href="#id18440">Selection</a>
          <ul>
            <li>
              <a href="#id18444">Selectable items</a>
            </li>
          </ul>
        </li>
        <li>
          <a href="#id18469">Transport bar</a>
          <ul>
            <li>
              <a href="#id18473">Recording</a>
            </li>
          </ul>
        </li>
        <li>
          <a href="#id18483">Menus</a>
          <ul>
            <li>
              <a href="#id18486">File menu</a>
            </li>
            <li>
              <a href="#id18490">Edit menu (<code>Alt+E</code>)</a>
            </li>
            <li>
              <a href="#id18770">View menu (<code>Alt+V</code>)</a>
            </li>
            <li>
              <a href="#id18797">TOC menu (<code>Alt+C</code>)</a>
            </li>
            <li>
              <a href="#id18879">Strips menu</a>
            </li>
            <li>
              <a href="#id18883">Blocks menu</a>
            </li>
            <li>
              <a href="#id18936">Transport menu</a>
            </li>
            <li>
              <a href="#id18940">Tools menu</a>
            </li>
            <li>
              <a href="#id18943">Help menu</a>
            </li>
          </ul>
        </li>
        <li>
          <a href="#id18946">Outdated stuff beyond this point</a>
        </li>
        <li>
          <a href="#id18959">What is Obi?</a>
        </li>
        <li>
          <a href="#id18967">The work area</a>
          <ul>
            <li>
              <a href="#id19010">The table of contents view (TOC view)</a>
            </li>
            <li>
              <a href="#id19034">Metadata view</a>
            </li>
            <li>
              <a href="#id19053">Strips view</a>
              <ul>
                <li>
                  <a href="#id19081">Strips</a>
                </li>
                <li>
                  <a href="#id19110">Blocks</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#id19292">Transport bar</a>
            </li>
            <li>
              <a href="#id19302">VU meter</a>
            </li>
          </ul>
        </li>
        <li>
          <a href="#id19310">Editing metadata</a>
        </li>
        <li>
          <a href="#id19314">Editing structure</a>
          <ul>
            <li>
              <a href="#id19323">Creating sections</a>
              <ul>
                <li>
                  <a href="#id19365">Using the dummy section</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#id19413">Renaming sections</a>
            </li>
            <li>
              <a href="#id19464">Changing section levels</a>
              <ul>
                <li>
                  <a href="#id19483">Move in</a>
                </li>
                <li>
                  <a href="#id19500">Move out</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#id19518">Used and unused sections</a>
            </li>
          </ul>
        </li>
        <li>
          <a href="#id19521">Editing contents</a>
          <ul>
            <li>
              <a href="#id19525">Page numbering</a>
            </li>
          </ul>
        </li>
        <li>
          <a href="#id19529">Editing audio</a>
        </li>
        <li>
          <a href="#id19532">Audio playback and recording</a>
          <ul>
            <li>
              <a href="#id19536">Playback</a>
            </li>
            <li>
              <a href="#id19539">Recording</a>
            </li>
          </ul>
        </li>
        <li>
          <a href="#id19543">Saving and exporting</a>
          <ul>
            <li>
              <a href="#id19546">XUK/.obi format</a>
            </li>
            <li>
              <a href="#id19550">Cleaning up</a>
            </li>
            <li>
              <a href="#id19553">Exporting to DAISY 3</a>
            </li>
            <li>
              <a href="#id19557">Using the DAISY Pipeline for import/export</a>
            </li>
          </ul>
        </li>
        <li>
          <a href="#id19561">User profile and preferences</a>
        </li>
      </ul>
    </div>
    <p>Now this is really the reference section.</p>
    <h2 id="id18408">Views</h2>
    <h3 id="id18411">Strips view</h3>
    <p>The main view is the <strong>strips view</strong>.</p>
    <h3 id="id18422">TOC view</h3>
    <h3 id="id18426">Metadata view</h3>
    <h3 id="id18429">Search view</h3>
    <h3 id="id18433">Transport bar</h3>
    <p>The transport bar is where playback and recording happen.</p>
    <h2 id="id18440">Selection</h2>
    <h3 id="id18444">Selectable items</h3>
    <ul>
      <li>
        <p>Section (in the TOC view): the selection is <em>deep</em>, so subsections and all
of their phrases are selected as well.</p>
      </li>
      <li>
        <p>Strip (in the strips view):</p>
      </li>
    </ul>
    <p><span class="todo">TODO</span>: handle waveform selection (position and chunk selection.)</p>
    <h2 id="id18469">Transport bar</h2>
    <h3 id="id18473">Recording</h3>
    <p>Undo acts at the phrase level: after recording has ended, undo will undo the
last recorded phrase, then the one before, etc. Sections that were created
during recording are also removed (<span class="todo">TODO</span>).</p>
    <h2 id="id18483">Menus</h2>
    <h3 id="id18486">File menu</h3>
    <h3 id="id18490">Edit menu (<code>Alt+E</code>)</h3>
    <p>Obi stores all executed commands in an <em>undo stack</em> so that commands can be
undone later. All commands executed since the current project was loaded are
stored so an unlimited number of commands can be undone. Undone commands are
also stored in a <em>redo stack</em> so that an undone command can be redone. Whenever
a new command is executed, the redo stack is cleared.</p>
    <ul>
      <li>
        <p><strong>Undo</strong> (<code>Ctrl+Z</code>): undo the last executed command.</p>
        <ul>
          <li><span class="todo">TODO</span>: save the undo stack in the XUK file.</li>
          <li><span class="todo">TODO</span>: when the project reverts to the last saved state, mark it as
unmodified.</li>
        </ul>
      </li>
      <li>
        <p><strong>Redo</strong> (<code>Ctrl+Y</code>): redo the last undone command.</p>
      </li>
    </ul>
    <p>Obi maintains a clipboard that contains the last cut or copied item. Undoing a
cut or copy operation restores the previous value of the clipboard.</p>
    <ul>
      <li>
        <p><strong>Cut</strong> (<code>Ctrl+X</code>): copy then delete the selected item. See description for
both commands below.</p>
      </li>
      <li>
        <p><strong>Copy</strong> (<code>Ctrl+C</code>): copy the selected item into the clipboard. When a section
is selected, all of its subsections are also copied, but when a strip is
selected, this strip only is selected.</p>
        <ul>
          <li><span class="todo">TODO</span>: copy a chunk of audio data.</li>
          <li><span class="todo">TODO</span>: copy text.</li>
          <li><span class="todo">TODO</span>: copy metadata (how exactly?)</li>
        </ul>
      </li>
      <li>
        <p><strong>Paste</strong> (<code>Ctrl+V</code>): paste the item in the clipboard in the current context.</p>
        <ul>
          <li>When the clipboard contains a strip or section (<em>i.e.</em> a section and
possibly subsections)...
<ul><li>... and a section is selected: paste a copy of the section in the
clipboard as the next sibling of the selected section.</li><li>... and a strip is selected: paste strips right after the selected
strip; the pasted section is at the same level as the section of the
selected strip.</li><li>... and a block is selected: same as if the strip in which the block is
was selected (<span class="todo">TODO</span>)</li></ul></li>
          <li>When the clipboard contains a block...
<ul><li>... and a section or strip is selected: paste a copy of the block at
the end of the strip (or the strip for the section.)</li><li>... and a block is selected: paste a copy of the block in the clipboard
after the selected block.</li></ul></li>
          <li><span class="todo">TODO</span>: impement dummy section in the TOC view to always have a selected
item to paste after, and being able to paste at the beginning.</li>
          <li><span class="todo">TODO</span>: implement dummy strip.</li>
          <li><span class="todo">TODO</span>: implement dummy block.</li>
          <li><span class="todo">TODO</span>: paste text.</li>
          <li><span class="todo">TODO</span>: paste audio data.</li>
        </ul>
      </li>
      <li>
        <p><strong>Delete</strong> (<code>Del</code>): delete the selected item. If it is a section, then all
subsections are deleted as well. If it is a strip, then only this strip is
deleted. If the corresponding section has subsection, the first subsection
is moved to the level of the deleted section so that the consistency of the
TOC is preserved.</p>
        <ul>
          <li><span class="todo">TODO</span>: delete a chunk of audio data. (Delete text works out of the box.)</li>
          <li><span class="todo">TODO</span>: trim audio data? (but this is not a generic edit function.)</li>
        </ul>
      </li>
      <li>
        <p><strong>Select nothing</strong> (<code>Alt+N</code>): deselect any item that was selected.</p>
        <ul>
          <li><span class="todo">TODO</span>: change the keyboard shortcut.</li>
        </ul>
      </li>
    </ul>
    <p>Athough Obi is an audio editing tool, a large project can still contain a non
trivial amount of text (section headings, metadata, annotations) so a search
function is provided.</p>
    <ul>
      <li>
        <p><strong>Find</strong> (<code>F3</code>): bring the search bar in focus and let the user type some
text to find. The first item containing this text is selected (in the case
of section titles, the strip corresponding to the section is selected.)</p>
        <ul>
          <li><span class="todo">TODO</span>: quick find with <code>/</code> as in <code>vi</code>.</li>
          <li><span class="todo">TODO</span>: search metadata.</li>
          <li><span class="todo">TODO</span>: buttons in the search bar (previous, next?)</li>
          <li><span class="todo">TODO</span>: replace?</li>
        </ul>
      </li>
    </ul>
    <h3 id="id18770">View menu (<code>Alt+V</code>)</h3>
    <ul>
      <li><strong>Show source view</strong> (<code>Alt+R</code>): show the source of the XUK file for this
project. This is mainly useful for debugging and may be removed from the
release version.
<ul><li><span class="todo">TODO</span>: change keyboard shortcut.</li></ul></li>
    </ul>
    <h3 id="id18797">TOC menu (<code>Alt+C</code>)</h3>
    <ul>
      <li>
        <p><strong>Add section</strong> (<code>Ctrl+A</code>): adds a new section after the selected section
and at the same level. If no section is selected, then add a new section at
the top level and at the end.</p>
        <ul>
          <li><span class="todo">TODO</span>: right now when nothing is selected, the new section is added at the
beginning. Fix this when dummy section is implemented.</li>
        </ul>
      </li>
      <li>
        <p><strong>Ad sub-section</strong> (<code>Ctrl+Shift+A</code>): adds a new section as the last child of
the selected section.</p>
      </li>
      <li>
        <p><strong>Rename section</strong> (<code>F2</code>): start editing the label of the section. The new
name cannot be empty. The change is committed when pressing <code>Return</code> or
cancelled when pressing <code>Esc</code>.</p>
      </li>
      <li>
        <p><strong>Move section in</strong> (<code>Ctrl+Shift+Left</code>):</p>
      </li>
      <li><strong>Move section out</strong> (<code>Ctrl+Shift+Right</code>):</li>
    </ul>
    <h3 id="id18879">Strips menu</h3>
    <h3 id="id18883">Blocks menu</h3>
    <ul>
      <li>
        <p><strong>Split block</strong> (<code>Ctrl+P</code>): split the block at the current cursor position.
The block is split in two blocks, one with all the audio data before the
cursor position, followed by one with the all the audio data after the cursor
position.</p>
        <ul>
          <li><span class="todo">TODO</span>: handle different kinds gracefully.</li>
          <li><span class="todo">TODO</span>: how to split nested blocks?</li>
        </ul>
      </li>
      <li>
        <p><strong>Merge block with next</strong> (<code>Ctrl+M</code>): merge this audio block with the
following block. The two blocks are replaced with a block that contains
the audio of both blocks.</p>
        <ul>
          <li><span class="todo">TODO</span>: if the blocks were of a different kind, the kind of the first block
is kept. This means that page numbers may disappear, etc.</li>
        </ul>
      </li>
    </ul>
    <h3 id="id18936">Transport menu</h3>
    <h3 id="id18940">Tools menu</h3>
    <h3 id="id18943">Help menu</h3>
    <h2 id="id18946">Outdated stuff beyond this point</h2>
    <p>The idea is that we document features first, then implement them. This way
we can better test if they behave as planned and we don't have to document
them later. This file can be the basis for the proper help page (with
screenshots, with more end-user hand-holding) with the objective of reusing
as much of it as possible.</p>
    <h2 id="id18959">What is Obi?</h2>
    <p>I am the introduction paragraph for the manual.</p>
    <h2 id="id18967">The work area</h2>
    <p>The work area shows the whole project at once and allows the user to focus
on specific parts while editing, recording and testing playback of a
project. The three main areas are:</p>
    <ol>
      <li>
        <p>The Table of Contents view, where the structure of the book is edited.</p>
      </li>
      <li>
        <p>The Metadata view, where the data <em>about</em> the book is edited.</p>
      </li>
      <li>
        <p>The Strips view, where the audio contents of the book are edited.</p>
      </li>
    </ol>
    <p>In addition, a transport bar acts as the interface for recording and
playback of the book. The figure below [to be replaced by an actual
screenshot] shows a sketch of the work area:</p>
    <pre>
+--------------------------------------------------------------------------+
|                         |                                                |
|         TOC view        |                   Strip view                   |
|                         |                                                |
|  * My book              |  +---------------------------------------------|
|    * First section      |  |                                             |
|    * Second section     |  |  My book                                    |
|      * First chapter    |  |                                             |
|      * Second chapter   |  |  +------------------------------------------|
|    * Third section      |  |  |            |           |             |   |
|                         |  |  |  Audio     |  Audio    |  Audio      |  A|
|                         |  |  |            |           |             |   |
|-------------------------|  |  +------------------------------------------|
|                         |  |                                             |
|        Metadata         |  +---------------------------------------------|
|                         |                                                |
|  Title: My book         |  +---------------------------------------------|
|  Author: Obird          |  |                                             |
|                         |  |  First section                              |
|--------------------------------------------------------------------------|
|                                                                          |
|                               Transport bar                              |
|                                                                          |
+--------------------------------------------------------------------------+
</pre>
    <h3 id="id19010">The table of contents view (TOC view)</h3>
    <p>The TOC view is shown as a sidebar of the strips view. If the Metadata view
is shown, the TOV view is shown above the Metadata view as shown in the
figure above. The TOC view can be hidden.</p>
    <p class="indent">The TOC view shows the sections and subsections in the book. It allows
hierarchical editing of sections (adding new sections and subsections,
changing the level of sections, renaming sections, etc.) Operations such as
deleting or copying sections are <em>deep</em>: they act not only on a section, but
on all of its contents, subsections as well as audio.  The audio content of
the sections themselves are managed in the strips view.</p>
    <h3 id="id19034">Metadata view</h3>
    <p>The metadata view is shown as a sidebar of the strips view. If the TOC view
is shown, the metadata view is shown underneath the TOC view as in the
figure above. The metadata view can be hidden.</p>
    <p class="indent">This is the view where the user edits the metadata for the project. The
DAISY spec mandates some entries to be present and Obi makes sure that these
entries are always present. It also helps the user add additional useful
metadata to her project. Some metadata is autogenerated (for instance the
total length of the book) and is not editable through this view.</p>
    <h3 id="id19053">Strips view</h3>
    <p>The strips view is where the audio contents of the book are edited. Every
section in the book is represented in a horizontal <em>strip</em>, where audio
contents are arranged in <em>blocks</em> that represent the audio units (such as
phrases) of the book.</p>
    <p class="indent">Contrary to the TOC view, the strips view is <em>flat</em>; the strips are
presented in the book order, but not in a hierarchical way. This is similar
to how they usually appear in the book, outside of its table of contents.</p>
    <h4 id="id19081">Strips</h4>
    <p>Strips are containers for blocks and map one-to-one with sections. They are
composed of:</p>
    <ul>
      <li>
        <p>The name of the section (same as shown in the TOC view, changing one
changes the other.)</p>
      </li>
      <li>
        <p>The thumbnail of the image label, if there is one (the full-size image can
be shown in a modal dialog.)</p>
      </li>
      <li>
        <p>The audio blocks, as described below.</p>
      </li>
    </ul>
    <h4 id="id19110">Blocks</h4>
    <p><strong>Block classes and properties.</strong> There are three basic kinds of blocks:</p>
    <ol>
      <li>
        <p>Plain <em>audio blocks</em> are the default kind of audio block.</p>
      </li>
      <li>
        <p><em>Page blocks</em> are used to represent page numbers. A page block has a page
number that can be edited and searched for. The audio data of a page block
is usually a reading of this page number.</p>
      </li>
      <li>
        <p><em>Heading blocks</em> are used to represent the audio label of sections in the
table of contents. There can be only one heading block per section, although
it does not have to be the first block.</p>
      </li>
    </ol>
    <p>Additionally, the user may create custom classes of blocks (for instance
producer notes, sidebars, etc.) which behave like regular blocks but can be
easily searched or manipulated as a class rather than block by block. This
is also useful for working with skippable blocks, as described below.</p>
    <p class="indent">Blocks can then the following properties; properties are either set (which
means that they do apply to this block) or unset (they do not.)</p>
    <ul>
      <li>
        <p>The <em>used</em> property means, when set, that the block is indeed part of the
book. By defaults, blocks are used (<em>i.e.</em> this property is set.) Unused
blocks will not play during normal playback of the book and will not be
exported to the final DAISY books. Unused blocks can also be removed all at
once during project cleanup.</p>
      </li>
      <li>
        <p>The <em>skippable</em> property means, when set, that this block can be
automatically skipped during playback. This property is generally used with
pages and custom blocks, so that for instance all producer notes in the book
can be skipped by default. DAISY players allow the reader to ultimately decide
whether they want these to be skipped or not.</p>
      </li>
      <li>
        <p>The <em>escapable</em> property means, when set, that playback can escape</p>
      </li>
      <li>
        <p>The <em>empty</em> property means, when set, that the block has no actual
content; it is just a placeholder. This can happen when importing a project,
or failing to read sound files from existing projects. The user can also
create empty blocks explicitly. This property is automatically set or unset
by Obi.</p>
      </li>
    </ul>
    <p>There is an additional property which is an <em>annotation string</em>. This is
purely for authoring and can be used to set short annotations on blocks
(<em>e.g.</em> <code>fix this'' or</code>to be recorded later'').</p>
    <p class="indent">Lastly, there is a special kind of block which instead of containing an
audio phrase, contains other blocks. We call this a <em>container block</em>. All
blocks in the container block share the properties of the container. As an
example, a container block can be used to group together several phrase
blocks to have an audio label consisting of several phrases (remember that
there can only be a single heading block per section; in that case the
container block is marked as being the heading block.)</p>
    <p class="indent">There are other examples of the use of container blocks, that can be marked
as escapable; for instance a list of phrases or an audio table (container
blocks can contain other container blocks, so a table can be a list of rows
which are themselves lists of phrases.)</p>
    <p class="indent"><strong>Display.</strong> A block is displayed as a colored rectangle that contains all
of the relevant information:</p>
    <ul>
      <li>
        <p>Block content: can be a waveform, other blocks (in case of a container
block), or an "empty" icon.</p>
      </li>
      <li>
        <p>Annotation</p>
      </li>
      <li>
        <p>Total audio length of the block</p>
      </li>
    </ul>
    <p>The block size is proportional to the size of its contents; longer audio
blocks are wider.</p>
    <h3 id="id19292">Transport bar</h3>
    <p>Used for recording and QA playback. Buttons are overloaded for recording;
for instance, the next phrase button introduces a new phrase. Whether this is
sufficient remains to be seen. An idea would be to modify the toolbar when
recording.</p>
    <h3 id="id19302">VU meter</h3>
    <p>Has its own window, or is part of the transport bar (text/small version.)</p>
    <h2 id="id19310">Editing metadata</h2>
    <h2 id="id19314">Editing structure</h2>
    <p>TOC view, TOC and Edit menus mostly. Don't forget to have the TOC view
visible to edit the document structure (see View menu.)</p>
    <h3 id="id19323">Creating sections</h3>
    <p>New sections are added after, or as subsections of existing sections. A new
section is created through the <em>Add section</em> menu item in the <em>TOC</em> menu. In
order to create a new section, an existing section must be selected. The new
section will always be created <em>after</em> the selected section, and then become
selected. New sections get a default label which can be immediately modified
by typing the desired name.</p>
    <p class="indent">Whenever a section is selected in the TOC view, a <em>dummy section</em> appears
underneath it. The dummy section can itself be selected to add a new section
<em>before</em> the first section or subsection of a section, or as the first
subsection of a section with no subsection yet. When no section is selected
in the TOC view, the dummy section appears as the first section of the book.
[NOTE use an actual, unused section as the dummy section.]</p>
    <h4 id="id19365">Using the dummy section</h4>
    <ul>
      <li>
        <p>Adding the first section in the project: since the TOC is empty, there
will be a dummy section in the TOC view. Select it then choose <em>add section</em>
from the <em>TOC</em> menu.</p>
      </li>
      <li>
        <p>Adding a subsection under an existing section: if there are no subsections
yet, select the section under which you want to add a subsection. A dummy
subsection will appear. Select it then choose <em>add section</em> from the <em>TOC</em>
menu. [NOTE is it too inconvenient to have to select twice for adding the
first subsection? Or worth keeping the <em>add subsection</em> menu item?]</p>
      </li>
      <li>
        <p>Adding a section before the first section: [NOTE maybe the
"root" dummy section should always be visible since unselecting in the TOC
view is inconvenient.]</p>
      </li>
    </ul>
    <h3 id="id19413">Renaming sections</h3>
    <p>A section can change its label simply by renaming it in the TOC view. This
can be done in several ways:</p>
    <ul>
      <li>
        <p>Select the section, then choose <em>rename section</em> in the <em>TOC</em> menu;</p>
      </li>
      <li>
        <p>Select the section, then click it again to start editing;</p>
      </li>
      <li>
        <p>Select the section, then press <code>F2</code>.</p>
      </li>
    </ul>
    <p>The section label will then become editable until you press the <code>Return</code> key
to validate. If you wish to cancel your edit, just press the <code>Escape</code> key.
A section cannot have an empty string as a label.</p>
    <h3 id="id19464">Changing section levels</h3>
    <p>[EXAMPLE]</p>
    <p class="indent">Note that changing the level of a section is a <em>shallow</em> operation as it
only changes the level of the selected section, and not its subsections.
Changing the level of a section and its subsections is better achieved
through cut-and-paste [NOTE and through multiple selection in the future.]</p>
    <h4 id="id19483">Move in</h4>
    <p>Moving a section <em>in</em> is the same as <em>increasing</em> its level. A section
cannot be moved in if it is the first subsection of its parent section (or
if it is the first section in the book.)</p>
    <h4 id="id19500">Move out</h4>
    <p>Moving a section <em>out</em> is the same as <em>decreasing</em> its level, so that the
level of a subsection becomes the same as its parent section's. As a
consequence, only subsections can be moved out; top-level sections already
have the lowest level.</p>
    <h3 id="id19518">Used and unused sections</h3>
    <h2 id="id19521">Editing contents</h2>
    <h3 id="id19525">Page numbering</h3>
    <h2 id="id19529">Editing audio</h2>
    <h2 id="id19532">Audio playback and recording</h2>
    <h3 id="id19536">Playback</h3>
    <h3 id="id19539">Recording</h3>
    <h2 id="id19543">Saving and exporting</h2>
    <h3 id="id19546">XUK/.obi format</h3>
    <h3 id="id19550">Cleaning up</h3>
    <h3 id="id19553">Exporting to DAISY 3</h3>
    <h3 id="id19557">Using the DAISY Pipeline for import/export</h3>
    <h2 id="id19561">User profile and preferences</h2>
  </body>
</html>
