<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Reference manual for Obi 1.0</title>
    <link rel="stylesheet" type="text/css" href="obi.css" />
  </head>
  <body>
    <div id="top">
      <h1>Reference manual for Obi 1.0</h1>
    </div>
    <p>
      <code>$Id$</code>
    </p>
    <div id="toc">
      <h2>Table of contents</h2>
      <ul>
        <li>
          <a href="#id18409">Views</a>
          <ul>
            <li>
              <a href="#id18418">Strips view</a>
              <ul>
                <li>
                  <a href="#id18433">Strips</a>
                </li>
                <li>
                  <a href="#id18461">Blocks</a>
                </li>
                <li>
                  <a href="#id18481">Different kinds of blocks</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#id18557">TOC view</a>
            </li>
            <li>
              <a href="#id18580">Metadata view</a>
            </li>
            <li>
              <a href="#id18593">Transport bar and peak meter</a>
            </li>
          </ul>
        </li>
        <li>
          <a href="#id18608">Selection</a>
          <ul>
            <li>
              <a href="#id18625">What is selectable?</a>
            </li>
            <li>
              <a href="#id18689">Label editing</a>
            </li>
          </ul>
        </li>
        <li>
          <a href="#id18714">Transport bar and peak meter</a>
          <ul>
            <li>
              <a href="#id18718">Controls</a>
            </li>
            <li>
              <a href="#id18721">Playback</a>
            </li>
            <li>
              <a href="#id18725">Recording</a>
            </li>
            <li>
              <a href="#id18728">Peak meter</a>
            </li>
          </ul>
        </li>
        <li>
          <a href="#id18732">Menus</a>
          <ul>
            <li>
              <a href="#id18735">File menu</a>
            </li>
            <li>
              <a href="#id18738">Edit menu (<code>Alt+E</code>)</a>
            </li>
            <li>
              <a href="#id19006">View menu (<code>Alt+V</code>)</a>
            </li>
            <li>
              <a href="#id19047">TOC menu (<code>Alt+C</code>)</a>
            </li>
            <li>
              <a href="#id19143">Strips menu</a>
            </li>
            <li>
              <a href="#id19204">Blocks menu (<code>Alt+B</code>)</a>
            </li>
            <li>
              <a href="#id19309">Transport menu</a>
            </li>
            <li>
              <a href="#id19313">Tools menu</a>
            </li>
            <li>
              <a href="#id19316">Help menu</a>
            </li>
          </ul>
        </li>
      </ul>
    </div>
    <p>Now this is really the reference section. If you're a user and not a
developper, you can ignore the items marked as <span class="todo">TODO</span>.</p>
    <h2 id="id18409">Views</h2>
    <p>The work area of Obi is composed of several views, as described below. All
views (except for the strips view) can be shown or hidden as necessary.</p>
    <h3 id="id18418">Strips view</h3>
    <p>The main view is the <em>strips view</em>. This is the view in which the contents of
the book are edited. There is a strip for every section in the book and they
appear in book order in the strips view. Inside each strip the actual contents
appear as blocks.</p>
    <h4 id="id18433">Strips</h4>
    <p>A <em>strip</em> represents a section and its contents. Subsections are represented as
other strips that follow in the strip view. Contents are represented as blocks
which are shown in book order inside the strip. A strip fills the entire width
of the strips view and has two parts:</p>
    <ol>
      <li>
        <p>an editable label showing the title of the section;</p>
      </li>
      <li>
        <p>a sequence of zero or more blocks.</p>
      </li>
    </ol>
    <h4 id="id18461">Blocks</h4>
    <p>A <em>block</em> is used to represent an unit of content in the strips view. A block
can be empty or contain audio. The audio content of a block is called a
<em>phrase</em> as it allows for the reader to skip easily from phrase to phrase
when the book is exported to DAISY. Obi does not impose any limitations on
the amount of audio that a block may contain.</p>
    <h4 id="id18481">Different kinds of blocks</h4>
    <ul>
      <li>
        <p><em>Empty blocks</em> are blocks that contain no audio. They can be used as
placeholders for adding audio at a later time. An empty block only contains
an information label. <span class="todo">TODO</span>: describe contents of label; something like "block
<em>n</em> of <em>m</em>."</p>
      </li>
      <li>
        <p><em>Plain blocks</em> are blocks that contain audio. In addition to the information
label, the waveform of the audio is displayed.</p>
      </li>
      <li>
        <p><em>Page blocks</em> are blocks that represent a page number. The corresponding
phrase is usually a reading of the page number. An actual number is
associated with the block. Example: page number 42 in the book can be
represented by a page block bearing the number 42 and the phrase "page
42." In the exported DAISY book, a page block will be skippable.</p>
      </li>
      <li>
        <p><em>Silence blocks</em> are used for phrase detection; see below.</p>
      </li>
      <li>
        <p><em>Custom blocks</em> are blocks that have some additional property in the current
book (such as producer notes, side bars, etc.) These can be defined by the
producer of the book as needed. In the exported DAISY book, custom blocks
will be skippable.</p>
      </li>
    </ul>
    <p><strong>Note:</strong> future versions of Obi will have <em>container blocks</em> that can hold
other blocks to create escapable structures, such as lists or audio tables,
but they are not included in the current release of Obi.</p>
    <h3 id="id18557">TOC view</h3>
    <p>The <em>table of contents view</em> (<em>TOC view</em> for short) shows the table of contents
of the book in a hierarchical way. Each entry in the table of contents is
called a <em>section</em>; this is a generic Obi term, and can be a book part,
chapter, section, subsection, etc. The level of each section is shown by its
indentation. As noted above, there is a corresponding strip for every section
in the TOC view.</p>
    <h3 id="id18580">Metadata view</h3>
    <p>The <em>metadata view</em> shows the metadata of the book: information such as title,
narrator, date of publication, etc. Metadata entries can be edited in this
view.</p>
    <h3 id="id18593">Transport bar and peak meter</h3>
    <p>The <em>transport bar</em> is used for recording and playback of the book. It has
buttons such as play, record, or stop; a time display; and a textual peak
meter. In addition to the transport bar, an external peak meter can also be
shown alongside Obi's main window.</p>
    <h2 id="id18608">Selection</h2>
    <p>All edits in Obi are based on the current selection. In the current version of
Obi, only a single selection can be made at once (future versions of Obi will
have multiple selection.)</p>
    <p class="indent">In general, selection is performed by clicking (and possibly dragging) on the
object or area to select; keyboard users can navigate to the desired region
to select (see keyboard navigation below.)</p>
    <h3 id="id18625">What is selectable?</h3>
    <ul>
      <li>In the strips view:
<ul><li>A strip is selectable.</li><li>The label of a strip is selectable. When selected, the label becomes
editable.</li><li>A position inside a strip is selectable. The position can be before the
first block, after the last block, or between two blocks.</li><li>A block inside a strip is selectable.</li><li>The waveform in a block is selectable; either a position or a range of
audio.</li></ul></li>
      <li>In the TOC view:
<ul><li>A section is selectable.</li><li>The text label of a section is selectable. When selected, it becomes
editable.</li></ul></li>
      <li>In the metadata view:
<ul><li>A metadata entry in the metadata view is selectable (<span class="todo">TODO</span>).</li><li>The text inside a metadata entry is selectable (<span class="todo">TODO</span>). When selected, it
becomes editable.</li></ul></li>
    </ul>
    <h3 id="id18689">Label editing</h3>
    <p>The label of a strip or a section, and the value of a metadata entry (<span class="todo">TODO</span>) can
be directly edited by clicking them. When typing <code>Enter</code>, the new name is
committed; typing <code>Esc</code> cancels the edit. Strips also have an <code>OK</code> and <code>Cancel</code>
button which achieve the same effects.</p>
    <h2 id="id18714">Transport bar and peak meter</h2>
    <h3 id="id18718">Controls</h3>
    <h3 id="id18721">Playback</h3>
    <h3 id="id18725">Recording</h3>
    <h3 id="id18728">Peak meter</h3>
    <h2 id="id18732">Menus</h2>
    <h3 id="id18735">File menu</h3>
    <h3 id="id18738">Edit menu (<code>Alt+E</code>)</h3>
    <p>Obi stores all executed commands in an <em>undo stack</em> so that commands can be
undone later. All commands executed since the current project was loaded are
stored so an unlimited number of commands can be undone. Undone commands are
also stored in a <em>redo stack</em> so that an undone command can be redone. Whenever
a new command is executed, the redo stack is cleared.</p>
    <ul>
      <li>
        <p><strong>Undo</strong> (<code>Ctrl+Z</code>): undo the last executed command.</p>
        <ul>
          <li><span class="todo">TODO</span>: save the undo stack in the XUK file.</li>
          <li><span class="todo">TODO</span>: when the project reverts to the last saved state, mark it as
unmodified.</li>
        </ul>
      </li>
      <li>
        <p><strong>Redo</strong> (<code>Ctrl+Y</code>): redo the last undone command.</p>
      </li>
    </ul>
    <p>Obi maintains a clipboard that contains the last cut or copied item. Undoing a
cut or copy operation restores the previous value of the clipboard.</p>
    <ul>
      <li>
        <p><strong>Cut</strong> (<code>Ctrl+X</code>): copy then delete the selected item. See description for
both commands below.</p>
      </li>
      <li>
        <p><strong>Copy</strong> (<code>Ctrl+C</code>): copy the selected item into the clipboard. When a section
is selected, all of its subsections are also copied, but when a strip is
selected, this strip only is selected.</p>
        <ul>
          <li><span class="todo">TODO</span>: copy a chunk of audio data.</li>
          <li><span class="todo">TODO</span>: copy text.</li>
          <li><span class="todo">TODO</span>: copy metadata (how exactly?)</li>
        </ul>
      </li>
      <li>
        <p><strong>Paste</strong> (<code>Ctrl+V</code>): paste the item in the clipboard in the current context.</p>
        <ul>
          <li>When the clipboard contains a strip or section (<em>i.e.</em> a section and
possibly subsections)...
<ul><li>... and a section is selected: paste a copy of the section in the
clipboard as the next sibling of the selected section.</li><li>... and a strip is selected: paste strips right after the selected
strip; the pasted section is at the same level as the section of the
selected strip.</li><li>... and a block is selected: same as if the strip in which the block is
was selected (<span class="todo">TODO</span>)</li></ul></li>
          <li>When the clipboard contains a block...
<ul><li>... and a section or strip is selected: paste a copy of the block at
the end of the strip (or the strip for the section.)</li><li>... and a block is selected: paste a copy of the block in the clipboard
after the selected block.</li></ul></li>
          <li><span class="todo">TODO</span>: impement dummy section in the TOC view to always have a selected
item to paste after, and being able to paste at the beginning.</li>
          <li><span class="todo">TODO</span>: implement dummy strip.</li>
          <li><span class="todo">TODO</span>: implement dummy block.</li>
          <li><span class="todo">TODO</span>: paste text.</li>
          <li><span class="todo">TODO</span>: paste audio data.</li>
        </ul>
      </li>
      <li>
        <p><strong>Delete</strong> (<code>Del</code>): delete the selected item. If it is a section, then all
subsections are deleted as well. If it is a strip, then only this strip is
deleted. If the corresponding section has subsection, the first subsection
is moved to the level of the deleted section so that the consistency of the
TOC is preserved.</p>
      </li>
      <li>
        <p><strong>Select nothing</strong> (<code>Alt+N</code>): deselect any item that was selected.</p>
        <ul>
          <li><span class="todo">TODO</span>: change the keyboard shortcut.</li>
        </ul>
      </li>
    </ul>
    <p>Athough Obi is an audio editing tool, a large project can still contain a non
trivial amount of text (section headings, metadata, annotations) so a search
function is provided.</p>
    <ul>
      <li>
        <p><strong>Find</strong> (<code>F3</code>): bring the search bar in focus and let the user type some
text to find. The first item containing this text is selected (in the case
of section titles, the strip corresponding to the section is selected.)</p>
        <ul>
          <li><span class="todo">TODO</span>: quick find with <code>/</code> as in <code>vi</code>.</li>
          <li><span class="todo">TODO</span>: search metadata.</li>
          <li><span class="todo">TODO</span>: buttons in the search bar (previous, next?)</li>
          <li><span class="todo">TODO</span>: replace?</li>
        </ul>
      </li>
    </ul>
    <h3 id="id19006">View menu (<code>Alt+V</code>)</h3>
    <ul>
      <li>
        <p><strong>Focus on Strips view</strong> (<code>F6</code>)</p>
      </li>
      <li>
        <p><strong>Show source view</strong> (<code>Alt+R</code>): show the source of the XUK file for this
project. This is mainly useful for debugging and may be removed from the
release version.</p>
        <ul>
          <li><span class="todo">TODO</span>: change keyboard shortcut.</li>
        </ul>
      </li>
    </ul>
    <h3 id="id19047">TOC menu (<code>Alt+C</code>)</h3>
    <p>The TOC menu provides operations on the table of contents.</p>
    <ul>
      <li>
        <p><strong>Add section</strong> (<code>Ctrl+A</code>): add a new section after the selected section
and at the same level. If no section is selected, then add a new section at
the top level and at the end. <span class="todo">TODO</span>: dummy section (adding before the first
section.)</p>
      </li>
      <li>
        <p><strong>Ad sub-section</strong> (<code>Ctrl+Shift+A</code>): add a new section as the last child of
the selected section.</p>
      </li>
      <li>
        <p><strong>Rename section</strong> (<code>F2</code>): start editing the label of the section. The new
name cannot be empty. The change is committed when pressing <code>Return</code> or
cancelled when pressing <code>Esc</code>.</p>
      </li>
      <li>
        <p><strong>Move section in</strong> (<code>Ctrl+Shift+Left</code>): increase the level of the section
by one. The section becomes the first subsection of its previous sibling
section; as a consequence, the first subsection of a section cannot be
moved in. Only the section moves, not its subsections.</p>
      </li>
      <li>
        <p><strong>Move section out</strong> (<code>Ctrl+Shift+Right</code>): decrease the level of the section
by one. Only sections without subsections can be moved out. Top-level
sections can obviously not be moved out.</p>
      </li>
      <li>
        <p><strong>Section is used</strong> (<code>Ctrl+K</code>): when a section is selected, the menu
item shows whether the section is used or not with a checkbox. The checkbox
is checked if the section is currently used. Selecting this item toggles the
used status of the section (from used to unused, and from unused to used.)
When the used status of the section changes, all subsections change to the
same status as well. The status of a section can only be changed if its
parent section is used (or if it is a top-level section), as there cannot
be used subsections of unused sections.</p>
      </li>
    </ul>
    <h3 id="id19143">Strips menu</h3>
    <ul>
      <li>
        <p><strong>Rename strip</strong> (<code>F2</code>): start editing the label of the strip. The new name
cannot be empty. The change is committed when pressing <code>Return</code> or cancelled
when pressing <code>Esc</code>.</p>
      </li>
      <li>
        <p><strong>Split strip</strong> (<code>Ctrl+Shift+P</code>): split the strip at the selected position
in the strip, or from the selected block. The new strip has the same label
and level as the original strip, and all the blocks starting from the split
position. If the first block or position is selected, there is no effect.</p>
      </li>
      <li>
        <p><strong>Merge strip with next</strong> (<code>Ctrl+Shift+M</code>): merge the selected strip with the
next one; that is, all the blocks in the following strip are appended to the
selected strip. The following strip is then removed from the project. If the
following strip has a lower level than the selected strip, merging is not
possible.</p>
      </li>
      <li>
        <p><span class="todo">TODO</span>: add strip, depending on cursor or strip selection.</p>
      </li>
    </ul>
    <h3 id="id19204">Blocks menu (<code>Alt+B</code>)</h3>
    <ul>
      <li>
        <p><strong>Add empty block</strong> (<code>Ctrl+Alt+A</code>): add a new empty block at the end of the
selected strip, or after the selected item in the strip.</p>
      </li>
      <li>
        <p><strong>Add empty page blocks</strong>: add one or more empty blocks with a page number.
A dialog opens where the user can choose the page number for the first block,
the number of blocks to add, and whether to renumber subsequent page blocks
automatically. The page number increases by one for each block (<em>e.g.</em> if
three pages are added starting at page number 4, the three page blocks will
be numbered 4, 5 and 6) and for subsequent pages if the user chooses to
renumber them (<em>e.g.</em> following pages would be renumbered 7, 8, 9, etc.)</p>
      </li>
      <li>
        <p><strong>Split block</strong> (<code>Ctrl+P</code>): split the block at the current cursor position.
The block is split in two blocks, one with all the audio data before the
cursor position, followed by one with the all the audio data after the cursor
position.</p>
        <ul>
          <li><span class="todo">TODO</span>: handle different kinds gracefully.</li>
          <li><span class="todo">TODO</span>: how to split nested blocks?</li>
        </ul>
      </li>
      <li>
        <p><strong>Merge block with next</strong> (<code>Ctrl+M</code>): merge this audio block with the
following block. The two blocks are replaced with a block that contains
the audio of both blocks.</p>
        <ul>
          <li><span class="todo">TODO</span>: if the blocks were of a different kind, the kind of the first block
is kept. This means that page numbers may disappear, etc.</li>
        </ul>
      </li>
      <li>
        <p><strong>Block is used</strong> (<code>Ctrl+K</code>): when a block is selected, the menu item shows
whether the block is used or not with a checkbox. The checkbox is checked if
the block is currently used. Selecting this item toggles the used status of
the block (from used to unused, and from unused to used.)</p>
      </li>
    </ul>
    <h3 id="id19309">Transport menu</h3>
    <h3 id="id19313">Tools menu</h3>
    <h3 id="id19316">Help menu</h3>
  </body>
</html>
